<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
        
        浏览器
    </title>
    <!-- 引入font-awesome图标 -->
    
<link rel="stylesheet" href="/css/font-awesome-4.7.0/css/font-awesome.min.css">
  

    
<link rel="stylesheet" href="/css/common.css">
  
    
<link rel="stylesheet" href="/css/layout.css">

    
    
        
<link rel="stylesheet" href="/css/post.css">

        
<link rel="stylesheet" href="/css/directory.css">

    
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
    <div class="navi-bar">
    
        
            <a class="navi-item" href="/" >
                首页2
            </a>
            <!-- onclick="selectMenu('/')" -->
        
            <a class="navi-item" href="/archives" >
                归档
            </a>
            <!-- onclick="selectMenu('/archives')" -->
        
            <a class="navi-item" href="/demo/index.html" >
                vue2.x
            </a>
            <!-- onclick="selectMenu('/demo/index.html')" -->
        
            <a class="navi-item" href="/" >
                vue3.x
            </a>
            <!-- onclick="selectMenu('/')" -->
        
            <a class="navi-item" href="/" >
                计算机网络
            </a>
            <!-- onclick="selectMenu('/')" -->
        
    
</div>
    
    <div class="wrapper">
        <div class="tools-bar">	
            
                
                
                    <a target="_blank" rel="noopener" href="https://github.com/IDKHTS"><i class="fa fa-github tools-bar-icon"></i></a>
                
            
            <!-- <a href=""><i class="fa fa-weibo"></i></a>
            <a target="_blank" rel="noopener" href="https://github.com/IDKHTS"><i class="fa fa-github"></i></a> -->
            <i class="fa fa-angle-double-up tools-bar-icon" onclick="onScrollTop()"></i>
            <i class="fa fa-angle-double-down tools-bar-icon" onclick="onScrollBottom()"></i>
        </div>
        <div class="left">
            <div class="dirctory py-2 px-1 bg-white">
                
                    <div class="dirctory-text px-2 py-1 mb-1">目录</div>
                    
    <div>不存在的...</div>

                
            </div>
        </div >
        <div class="right">
            <div class="bg-white px-3 pb-3">
    <!-- 为了方便目录的渲染，不用h1等，直接写样式 -->
    <div class="post-h1 py-2">浏览器</div>

    <div>
        <ul>
<li><p>主要构成部分：</p>
<ul>
<li>用户界面</li>
<li>浏览器引擎（WebCore）负责窗口管理、Tab进程管理</li>
<li>渲染引擎，也叫内核，负责html解析、页面渲染</li>
<li>Js引擎，JsCore，js的解释执行</li>
</ul>
</li>
<li><p>浏览器为</p>
<ul>
<li><p>多进程有四种：渲染进程、插件进程、GPU进程、浏览器进程</p>
</li>
<li><p>多线程（js引擎才是单线程）,主要看渲染进程，它包括</p>
<ul>
<li>GUI线程，负责解析html、css和渲染页面 相关的</li>
<li>JS引擎线程，负责js的解释执行（统一时期只能有一个此类线程执行）</li>
<li>事件线程，控制事件循环相关逻辑（定时器和异步请求的回调）</li>
<li>定时器线程，处理定时器相关逻辑</li>
<li>异步请求线程，发起Ajax时会生成该线程</li>
</ul>
<p>注意：GUI线程和Js引擎线程是互斥的，即当GUI线程执行时，js引擎会停下，反之亦然。</p>
<p>这里说一下自我理解的js为什么设计为单线程吧，首先js是一门脚本语言，它只是需要在浏览器中运行，所以应该尽可能的简单，抛弃了一些多线程操作（这样就可以减少因为操作同一资源而使用锁，等复杂情况）设计成了单线程。同时因为是单线程且js是面向用户的，用户使用体验提高是刚需，所以js又需要是异步的，不用阻塞等待。</p>
<p>总的来说就是：简单的脚本——》单线程——》异步；</p>
<p>应该也是这个原因——不能同时操作一个资源，DOM要么被GUI线程操作（计算布局）要么被js操作（增删改DOM），所以才有上面的注意，js和GUI线程在同一时刻只能执行一个。</p>
</li>
</ul>
</li>
<li><p>页面渲染：</p>
<ul>
<li>解析html生成Dom树（中间遇到js，停下，执行js）</li>
<li>解析css生成css对象模型树（CSSOM）</li>
<li>合并DOM和CSSOM生成渲染树（render树）</li>
<li>根据渲染树进行计算布局（layout）然后绘制（painting）得到页面</li>
</ul>
<p>在应用被使用的过程中可能会产生一些增减DOM节点的操作，由上面过程可以知道，DOM树会被改变，这时就需要重新构建渲染树，再进行渲染，而这过程称重排或者回流（reflowing）；倘若DOM节点改变的只是一些字体背景颜色，不影响布局，不需要重新计算时，只需要重新绘制，这个操作称重绘。</p>
<p>重排则必定包含重绘；当改变的无关布局的（字体颜色等），则会触发重绘而不必重排</p>
</li>
<li><p>浏览器缓存</p>
<ul>
<li><p>由浏览器实现的http缓存：</p>
<ul>
<li>强缓存</li>
<li>协商缓存</li>
</ul>
</li>
<li><p>强缓存：其实就一种比较强制性的匹配缓存规则而已</p>
<ul>
<li>概述：总的的来说就是，服务端第一次响应客户端发送的请求时给予客户端一个时间，表明这些数据在这个时间内一定不会改变数据（改变也可以，但客户端不需要知道），可以直接读缓存，<strong>不用再次发送http请求</strong></li>
<li>具体使用：<ul>
<li>http1.0时使用的字段<code>Express</code>，它的值是一个绝对时间，如<code> Wed, 21 Oct 2020 07:28:00 GMT</code>。第一次时，http响应头带着这个字段，浏览器就会缓存下这些数据，并且在应用在这个时间，<code>2020.10.21 07:28:00</code> 前，再次请求这个url时读缓存中的这些数据返回，不发送http请求</li>
<li>http1.1时使用的字段是<code>Cache-Control</code>,它的值是一个相对的时间，如<code>max-age=3600</code>。第一次请求时，http响应头带着这个字段，浏览器会缓存下这些数据，并且在应用在过了这个相对时间，3600秒前，再次请求这个url时读缓存中的这些数据返回，不发送http请求</li>
</ul>
</li>
<li>http1.1的记录的相对时间会比绝对时间好一点，因为客户端的时间（用户的电脑）可以是不准确的，如果偏后，那么浏览器就可能读不到缓存直接再次请求数据，缓存就失效了。使用相对时间，无论如何，距离上次请求的一段时间都读缓存，客户端时间无法再干扰到了。</li>
</ul>
</li>
<li><p>协商缓存：另一种的匹配缓存规则</p>
<ul>
<li><p>概述：相对强缓存由浏览器判断是否读缓冲，协商缓存把这个判断放到了服务端，即<strong>客户端请求会到达服务端</strong>，这个是和强缓存最大的区别。客户端请求时，服务端会返回一个标记，客户端再次请求时，请求头应该带上这个标记，服务端根据这个标记判断客户端上次请求的数据是否还能用，能用就返回一个http状态码，让浏览器读缓存里的数据，不能用就返回能用的数据。</p>
</li>
<li><p>具体使用：</p>
<ul>
<li>使用<code>Last-Modified</code>/<code>If-Modified-Since</code>这一对字段。第一次响应时，服务端在响应头里增加<code>Last-Modified</code>字段，值是时间，表示数据最新的更改时间；下一次再请求相同的数据，浏览器会在请求头里增加字段<code>If-Modified-Since</code>，值就是<code>Last-Modified</code>的时间，请求到达服务端后，服务端就读到<code>If-Modified-Since</code>这个字段的时间比对数据更新的最新时间，相同就返回304，让浏览器读缓存里的数据，不然就返回最新的数据。</li>
</ul>
</li>
<li><p>使用</p>
<p><code>ETag</code>/<code>If-None-Match</code>这一对字段。</p>
<p><code>ETag</code>的值是一段内容摘要（hash）。类似的，第一次响应的响应头部也会带上一个<code>ETag</code>字段，下次请求在请求头部加<code>If-None-Match</code>带上这个<code>Etag</code>的值，服务端拿着和现在的数据摘要对比，相同则返回304，不同则返回最新数据；</p>
<ul>
<li><code>ETag</code>/<code>If-None-Match</code>相比<code>Last-Modified</code>/<code>If-Modified-Since</code>是一种更强的校验器，<code>Last-Modified</code>的时间只能精确到秒。同时<code>ETag</code>/<code>If-None-Match</code>也比<code>Last-Modified</code>/<code>If-Modified-Since</code>优先级更高。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>随记：</p>
<ul>
<li>这些缓存都是针对get，head这些读数据的方法而言，那些字段也有自身的一些其它用法</li>
</ul>
</li>
</ul>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Caching_FAQ">HTTP 缓存</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Expires">Expires</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Cache-Control">Cache-Control</a><br><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/ETag">ETag</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/If-None-Match">If-None-Match</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/If-Match">If-Match</a></p>
<p><a target="_blank" rel="noopener" href="https://web.dev/http-cache/">Prevent unnecessary network requests with the HTTP Cache</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844904021308735502#heading-4">(1.6w字)浏览器灵魂之问，请问你能接得住几个？</a></p>

    </div>
</div>

    <section class="comments" id="comments">
        <div id="gitalk-container"></div>
        <!-- <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
        <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script> -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
        <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
        <script>
            let admins = 'IDKHTS'
            let arrPathName = (location.pathname).split("/")
            let gitalkID = ''
            for(let i = arrPathName.length-1;i >= 0 ;i--){
                if(arrPathName[i] !== '/') gitalkID = arrPathName[i].substring(0, 49)
            }
            var gitalk = new Gitalk({
                clientID: '884f505b74829948187e',
                clientSecret: '4e414213f820b3ddde39e15a53c2b5a70c301c5d',
                repo: 'idkhts.github.io',
                owner: 'IDKHTS',
                admin: admins.split(','),
                id: gitalkID,//location.pathname,  // Ensure uniqueness and length less than 50
                perPage: 50,
                distractionFreeMode: 'false'
            })

            gitalk.render('gitalk-container')
        </script>
    </section>
    

<!-- 
    page的属性
'title',          '_content',
'source',         'raw',
'slug',           'published',
'date',           'updated',
'comments',       'layout',
'photos',         'link',
'_id',            'content',
'site',           'excerpt',
'more',           'path',
'permalink',      'full_source',
'asset_dir',      'tags',
'categories',     'next',
'__post',         'lang',
'canonical_path' -->
        </div>
    </div>

    

    
<script src="/js/layout.js"></script>

    
    
        
<script src="/js/post.js"></script>

    
</body>

</html>